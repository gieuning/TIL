# 2025-01-05

## MVC(Model View Controller)

- Controller: HTTP 요청을 받아서 파라미터를 검증하고, 비즈니스 로직을 실행. 뷰에 전달할 결과
  데이터를 조회해서 모델에 담는다.
- Model: 뷰에 출력할 데이터를 담아둔다. 뷰가 필요한 데이터를 모두 모델에 담아서 전달해주는 덕분에 뷰는 비즈니스 로직이나
  데이터 접근을 몰라도 되고, 화면을 렌더링 하는 일에 집중할 수 있다.
- View: 모델에 담겨있는 데이터를 사용해서 화면을 그리는 일에 집중한다. (HTML을 생성하는 부분)

## ex) 회원 조회 요청 처리 흐름
1. 요청
- 사용자가 /members URL로 GET 요청을 보냄.
2. 컨트롤러
- @GetMapping("/members")에 매핑된 메서드 실행.
- 요청 파라미터가 필요한 경우 @RequestParam으로 추출.
- 요청 유효성 검증 수행.
- 비즈니스를 호출하고 모델에 데이터를 담고 VIEW로 던진다.
- (사용자가 컨트롤러를 호출을 하면, 컨트롤러는 파라미터를 꺼내고, 고객이 제대로 요청한건지, HTTP 요청이 제대로 맞는지 스펙을 확인.)

3. 서비스 호출
- MemberService.findMembers() 메서드 호출.
- 서비스에서 MemberRepository를 통해 DB에서 회원 목록 조회.
- (로직이 잘 맞으면 서비스나 리포지토리 같은 걸 호출을 해서 여기 있는 데이터를 저장하거나, 주문을 하는 로직을 실행 후 결과를 받는다.)

4. 데이터 모델에 저장
- 조회된 회원 목록 데이터를 Model 객체에 저장.
- `model.addAttribute("members", members);`
5. 뷰로 데이터 전달 및 출력
- 뷰 템플릿 엔진(예: Thymeleaf, JSP)을 사용해 HTML 생성.
- 생성된 HTML을 사용자에게 반환.


일반적으로 비즈니스 로직은 서비스(Service)라는 계층을 별도로 만들어서 처리.
컨트롤러는 비즈니스 로직이 있는 서비스를 호출하는 담당.
참고로 비즈니스 로직을 변경하면 비즈니스 로직을 호출하는 컨트롤러의 코드도 변경될 수 있다.

모델 - `request.setAttribue` 임시 저장소

request는 내부에 데이터 저장소를 가지고 있다.
`request.setAttribue()`, `request.getAttribue()` - 데이터를 보관하고, 조회할 수 있다.

MVC 패턴을 쓰면 항상 컨트롤러을 거쳐서 뷰로 들어가야 한다.
그럼 일단 컨트롤러로 요청이 들어와야 함
`request.getRequestDispatcher()` - 컨트롤러에서 뷰로 이동할때 사용

`dispatcher.forward(request, response);` - 다른 서블릿이나 JSP로 이동할 수 있는 기능. 서버 내부에서 다시 호출이 발생

### redirect vs forward
리다이렉트는 실제 클라이언트(웹 브라우저)에 응답이 나갔다가, 클라이언트가 redirect 경로로 다시 요청한다.
따라서 클라이언트가 인지할 수 있고, URL 경로도 실제로 변경된다.
반면에 포워드는 서버 내부에서 일어나는 호출이기 때문에 클라이언트가 전혀 인지하지 못한다.

## MVC 단점
**컨트롤러 복잡성 증가**
- 애플리케이션이 커지고 기능이 늘어나면서, 컨트롤러에 공통 로직이 점점 많아진다.

    -  예를 들어, 인증, 권한 확인, 데이터 검증, 로깅, 예외 처리 등은 거의 모든 컨트롤러에서 필요하다.

    - 이러한 작업이 반복되면 컨트롤러가 복잡해지고, 각 메서드가 비즈니스 로직보다 공통 작업에 더 많은 코드를 포함하게 된다.

**공통 메서드 호출의 실수 가능성**

- 공통 기능을 메서드로 분리하더라도, 각 컨트롤러나 메서드에서 이를 호출하는 것을 개발자가 잊을 가능성이 있다,

    - 예를 들어, 로그 기록 메서드를 호출하지 않거나 데이터 검증 로직을 생략하면 의도치 않은 오류나 보안 문제가 발생할 수 있다.


**중복 코드**

공통 메서드 호출 자체가 모든 컨트롤러 메서드에 반복적으로 나타나며, 이는 코드 중복을 초래한다.
공통 로직이 추가되거나 변경될 때, 이를 일관성 있게 적용하는 데 어려움이 생길 수 있다.

**테스트 및 유지보수 어려움**
- 공통 로직이 각 컨트롤러 메서드에서 반복되면, 이를 테스트하거나 유지보수하기 어려워진다.
- 공통 로직이 잘못되었을 경우, 모든 컨트롤러에서 이를 일일이 찾아 수정해야 할 수도 있다.

출처 - 김영한 스프링 MVC 1편 - 백엔드 웹 개발 핵심 기술
# 2024-12-26
---

# μ¤λ κ³µλ¶€ λ‚΄μ©

## AOP
- μ• ν”λ¦¬μΌ€μ΄μ…μ ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό κ³µν†µμ μΌλ΅ μ μ©λλ” λ¶€κ°€ κΈ°λ¥μ„ λ¶„λ¦¬ν•μ—¬ μ½”λ“λ¥Ό λ¨λ“ν™”ν•λ” ν”„λ΅κ·Έλλ° ν¨λ¬λ‹¤μ„
- κ°μ²΄ μ§€ν–¥ ν”„λ΅κ·Έλλ°μ„ λ³΄μ™„ν•λ” ν¨λ¬λ‹¤μ„μΌλ΅, ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό ν΅λ‹¨ κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•μ—¬ λ¨λ“ν™”ν•λ” ν”„λ΅κ·Έλλ° κΈ°λ²•
- `ν•µμ‹¬ κΈ°λ¥` λΉ„μ¦λ‹μ¤ λ΅μ§μ„ κµ¬ν„ν•λ” κ³Όμ •μ—μ„ λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ μ²λ¦¬ν•λ ¤λ” λ©μ  κΈ°λ¥μ„ λ§ν•¨
- ex) ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μƒν’ μ •λ³΄ λ“±λ΅ μ”μ²­μ„ λ°›μ•„ DBμ— μ €μ¥ν•κ³ , κ·Έ μƒν’ μ •λ³΄λ¥Ό μ΅°νν•λ” λΉ„μ¦λ‹μ¤ λ΅μ§μ„ κµ¬ν„ν•λ‹¤λ©΄ μ•„λ μ‚¬ν•­μ΄ ν•µμ‹¬ κΈ°λ¥
    - μƒν’ μ •λ³΄λ¥Ό DBμ— μ €μ¥
    - μ§€μ •λ μƒν’ μ •λ³΄ λ°μ΄ν„°λ¥Ό λ³΄μ—¬μ£Όλ” μ½”λ“

### ν΅λ‹¨ κ΄€μ‹¬μ‚¬
- μ—¬λ¬ λ¨λ“μ— κ±Έμ³ κ³µν†µμ μΌλ΅ μ μ©λλ” κ΄€μ‹¬μ‚¬
- μ) λ΅κΉ…, νΈλμ­μ… κ΄€λ¦¬, μΈμ¦/μΈκ°€, μΊμ‹± λ“±.
- λ΅κΉ…: λ©”μ„λ“μ΄ νΈμ¶κ³Ό λ°ν™ κ°’μ„ λ΅κΉ…ν•λ” μ‘μ—…μ€ λ§μ€ μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ μ¤‘μ”
    - AOPλ¥Ό μ‚¬μ©ν•λ©΄ λ¨λ“  λ©”μ„λ“ νΈμ¶μ— λ€ν• λ΅κ·Έλ¥Ό μ¤‘μ•™μ—μ„ κ΄€λ¦¬ν•  μ μλ‹¤.
- νΈλμ­μ… κ΄€λ¦¬
    - DB νΈλμ­μ…μ„ κ΄€λ¦¬ν•  λ• AOPλ¥Ό μ‚¬μ©ν•μ—¬ νΈλμ­μ…μ μ‹μ‘κ³Ό μΆ…λ£, λ΅¤λ°± λ“±μ„ μ²λ¦¬ν•  μ μλ‹¤. μ΄λ¥Ό ν†µν•΄ μ½”λ“ μ¤‘λ³µμ„ μ¤„μ΄κ³  νΈλμ­μ… μ½”λ“λ¥Ό λ¶„λ¦¬ν•μ—¬ κ΄€λ¦¬


### ν•µμ‹¬ κ΄€μ‹¬μ‚¬
- μ• ν”λ¦¬μΌ€μ΄μ…μ μ£Όμ” λΉ„μ¦λ‹μ¤ λ΅μ§
- AOPλ” ν•µμ‹¬ κ΄€μ‹¬μ‚¬μ— μν–¥μ„ μ£Όμ§€ μ•κ³  ν΅λ‹¨ κ΄€μ‹¬μ‚¬λ¥Ό μ²λ¦¬ν•λ” λ° μ΄μ μ„ λ§μ¶¤

AOPμ κ²°λ΅  - κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•μ—¬ κ°€λ…μ„±, μ μ§€λ³΄μμ„±, μ¬μ‚¬μ©μ„±μ„ ν–¥μƒ

## AOP λ™μ‘ μ›λ¦¬
1. Target ν΄λμ¤
- μ‹¤μ  ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§μ„ μν–‰ν•λ” ν΄λμ¤μ™€ λ©”μ„λ“.
2. Advice μ •μ
- νΉμ • λ΅μ§ μ‹¤ν–‰ μ „, ν›„, μμ™Έ λ°μƒ μ‹μ— μ‹¤ν–‰λ  κ³µν†µ λ΅μ§μ„ μ‘μ„±.
3. Pointcut μ„¤μ •
- Adviceκ°€ μ μ©λ  λ©”μ„λ“λ¥Ό μ‹λ³„ν•κΈ° μ„ν•΄ ν‘ν„μ‹μ„ μ‚¬μ©ν•μ—¬ κ·μΉ™ μ„¤μ •.
4. Advisor κµ¬μ„±
- Adviceμ™€ Pointcutμ„ μ—°κ²°ν•μ—¬ νΉμ • μ΅°κ±΄μ—μ„ Adviceλ¥Ό μ‹¤ν–‰.
5. Proxy μƒμ„± λ° μ‹¤ν–‰
- μ¤ν”„λ§ AOP ν”„λ΅μ‹κ°€ Target κ°μ²΄λ¥Ό κ°μ‹Έκ³  Join Pointμ—μ„ Advice μ‹¤ν–‰.

<details>
<summary>XML μμ‹ μ½”λ“</summary>

```xml
 <beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:aop="http://www.springframework.org/schema/aop"
        xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd">

    <!-- Target ν΄λμ¤ -->
    <bean id="target" class="com.example.Target"/>

    <!-- Advice ν΄λμ¤ -->
    <bean id="loggingAdvice" class="com.example.LoggingAdvice"/>

    <!-- Pointcut μ •μ -->
    <aop:config>
        <aop:pointcut id="writePointcut" expression="execution(* com.example.Target.write(..))"/>

        <!-- Advisor κµ¬μ„± -->
        <aop:advisor advice-ref="loggingAdvice" pointcut-ref="writePointcut"/>
    </aop:config>
</beans>
```

</details>

<details> 
<summaery>μλ°” μ½”λ“ μμ </summaery>

```java
- Target ν΄λμ¤ 
@Component
public class Target {
    public void write(String data) {
        System.out.println("Writing data: " + data);
    }
}

- Advice ν΄λμ¤
@Aspect
@Component
public class LoggingAdvice {

  @Before("execution(* com.example.Target.write(..))")
  public void beforeAdvice() {
    System.out.println("Before writing data.");
  }

  @After("execution(* com.example.Target.write(..))")
  public void afterAdvice() {
    System.out.println("After writing data.");
  }
}

- Java Config
    
@Configuration
@EnableAspectJAutoProxy
@ComponentScan(basePackages = "com.example")
public class AppConfig {
}

- Main ν΄λμ¤
public class Main {
  public static void main(String[] args) {
    ApplicationContext context = new AnnotationConfigApplicationContext(AppConfig.class);
    Target target = context.getBean(Target.class);
    target.write("Hello, AOP!");
  }
}
```
--- 
μ‹¤ν–‰ κ²°κ³Ό
Before writing data.
Writing data: Hello, AOP!
After writing data.
</details>

### π€ AOP μ£Όμ” κ°λ…

| **κ°λ…**            | **μ„¤λ…**                                                                                     |
|---------------------|---------------------------------------------------------------------------------------------|
| Aspect              | AOPμ λ‹¨μ„λ΅, κ΄€μ‹¬μ‚¬μ λ¨λ“ν™”. μ–΄λ“λ°”μ΄μ¤μ™€ ν¬μΈνΈμ»·μ„ ν¬ν•¨.                                  |
| Advice              | μ΅°μΈ ν¬μΈνΈμ—μ„ μ‹¤ν–‰λλ” μ‘μ—…. `@Before`, `@After`, `@Around` λ“±μΌλ΅ μ •μ.                     |
| Pointcut            | μ–΄λ“λ°”μ΄μ¤κ°€ μ μ©λ  ν•λ‚ μ΄μƒμ μ΅°μΈ ν¬μΈνΈλ¥Ό μ •μν•λ” ν‘ν„μ‹.                                 |
| Join Point          | μ–΄λ“λ°”μ΄μ¤κ°€ μ μ©λ  μ μλ” νΉμ • μ‹¤ν–‰ μ§€μ  (μ: λ©”μ„λ“ νΈμ¶).                                  |
| Target Object       | μ–΄λ“λ°”μ΄μ¤κ°€ μ μ©λλ” μ‹¤μ  κ°μ²΄.                                                              |
| Proxy Object        | AOP ν”„λ΅μ‹κ°€ μƒμ„±ν• κ°μ²΄. νƒ€κ² κ°μ²΄λ¥Ό λ€μ‹ ν•μ—¬ μ”μ²­μ„ μ²λ¦¬.                                   |
| Weaving             | Aspectμ™€ Target Objectλ¥Ό κ²°ν•©ν•λ” κ³Όμ •. (μ»΄νμΌ νƒ€μ„, λ΅λ“ νƒ€μ„, λ°νƒ€μ„ λ“±)                   |

---

### π€ AOP ν‘ν„μ‹ (Pointcut)

| **ν‘ν„μ‹**          | **μ„¤λ…**                                                                                     |
|---------------------|---------------------------------------------------------------------------------------------|
| `execution`         | λ©”μ„λ“ μ‹¤ν–‰ μ΅°μΈ ν¬μΈνΈλ¥Ό μ§€μ •. λ©”μ„λ“ μ΄λ¦„, λ¦¬ν„΄ νƒ€μ…, λ§¤κ°λ³€μ λ“±μ„ ν¬ν•¨ κ°€λ¥.                |
| `within`            | νΉμ • νƒ€μ…(ν΄λμ¤ λλ” ν¨ν‚¤μ§€)μ λ¨λ“  μ΅°μΈ ν¬μΈνΈλ¥Ό μ§€μ •.                                       |
| `this`              | ν”„λ΅μ‹ κ°μ²΄μ νƒ€μ…κ³Ό μΌμΉν•λ” μ΅°μΈ ν¬μΈνΈλ¥Ό μ§€μ •.                                              |
| `target`            | λ€μƒ κ°μ²΄μ νƒ€μ…κ³Ό μΌμΉν•λ” μ΅°μΈ ν¬μΈνΈλ¥Ό μ§€μ •.                                                |
| `args`              | μ „λ‹¬λ μΈμμ νƒ€μ…κ³Ό μΌμΉν•λ” μ΅°μΈ ν¬μΈνΈλ¥Ό μ§€μ •.                                              |
| `@annotation`       | νΉμ • μ• λ…Έν…μ΄μ…μ΄ μ μ©λ μ΅°μΈ ν¬μΈνΈλ¥Ό μ§€μ •.                                                   |

---

### π€ AOP κ΄€λ ¨ μ• λ…Έν…μ΄μ…

| **μ• λ…Έν…μ΄μ…**      | **λ©μ **                                                                                     |
|---------------------|---------------------------------------------------------------------------------------------|
| `@Aspect`           | AOPμ κ΄€μ (Aspect)μ„ μ •μ. AOPλ¥Ό μ‚¬μ©ν•λ ¤λ©΄ ν΄λμ¤μ— μ΄ μ• λ…Έν…μ΄μ…μ„ μ¶”κ°€ν•΄μ•Ό ν•¨.            |
| `@Before`           | μ§€μ •λ μ΅°μΈ ν¬μΈνΈ μ „μ— μ–΄λ“λ°”μ΄μ¤λ¥Ό μ‹¤ν–‰.                                                   |
| `@After`            | μ§€μ •λ μ΅°μΈ ν¬μΈνΈ ν›„μ— μ–΄λ“λ°”μ΄μ¤λ¥Ό μ‹¤ν–‰.                                                   |
| `@AfterReturning`   | μ΅°μΈ ν¬μΈνΈκ°€ μ •μƒμ μΌλ΅ μ™„λ£λ ν›„ μ–΄λ“λ°”μ΄μ¤λ¥Ό μ‹¤ν–‰. λ°ν™ κ°’μ„ μ²λ¦¬ν•  μ μμ.                |
| `@AfterThrowing`    | μ΅°μΈ ν¬μΈνΈμ—μ„ μμ™Έκ°€ λ°μƒν–μ„ λ• μ–΄λ“λ°”μ΄μ¤λ¥Ό μ‹¤ν–‰.                                         |
| `@Around`           | μ΅°μΈ ν¬μΈνΈ μ „ν›„μ— μ–΄λ“λ°”μ΄μ¤λ¥Ό μ‹¤ν–‰. λ©”μ„λ“ μ‹¤ν–‰ μ μ–΄ λ° λ°ν™ κ°’μ„ λ³€κ²½ κ°€λ¥.                 |
| `@Pointcut`         | μ¬μ‚¬μ© κ°€λ¥ν• ν¬μΈνΈμ»·(μ΅°μΈ ν¬μΈνΈλ¥Ό μ§€μ •ν•λ” ν‘ν„μ‹)μ„ μ •μ.                                 |
---


### π€ AOP μ„¤μ • κ΄€λ ¨ μ• λ…Έν…μ΄μ…

| **μ• λ…Έν…μ΄μ…**      | **λ©μ **                                                                                     |
|---------------------|---------------------------------------------------------------------------------------------|
| `@EnableAspectJAutoProxy` | AOP ν”„λ΅μ‹λ¥Ό ν™μ„±ν™”. Spring AOP μ„¤μ • μ‹ ν•„μ.                                                |

---

## AOPμ μ£Όμ” Advice
- MethodBeforeAdvice: λ€μƒ κ°μ²΄μ λ©”μ„λ“ μ‹¤ν–‰ μ „μ— κ³µν†µ κΈ°λ¥μ„ μ‹¤ν–‰. λ©”μ„λ“ μ‹¤ν–‰ μ „ λ°μ΄ν„° κ²€μ¦, λ΅κΉ…, λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° μ„¤μ • λ“±μ— μ‚¬μ©.
- AfterReturningAdvice: λ€μƒ κ°μ²΄μ λ©”μ„λ“ μ‹¤ν–‰ ν›„ κ³µν†µ κΈ°λ¥μ„ μ‹¤ν–‰. μμ™Έ μ—†μ΄ μ„±κ³µμ μΌλ΅ μ‹¤ν–‰λ κ²½μ°μ—λ§ μ μ©. κ²°κ³Ό λ΅κΉ…, νΈλμ­μ… μ»¤λ°‹, λ¦¬μ†μ¤ μ •λ¦¬μ— μ μ©.
- MethodInterceptor: λ©”μ„λ“ μ‹¤ν–‰ μ „, ν›„, λλ” μμ™Έ λ°μƒ μ‹μ μ—μ„ κ³µν†µ κΈ°λ¥μ„ μ‹¤ν–‰. Before, AfterReturning, ThrowAdviceλ¥Ό ν•λ‚λ΅ λ¬¶μ–΄ κ΄€λ¦¬ κ°€λ¥.

---

μμ  μ‹λ‚λ¦¬μ¤
Target: μ‹¤μ  μ‘μ—…μ„ μν–‰ν•λ” ν•µμ‹¬ ν΄λμ¤μ™€ λ©”μ„λ“ (μ: write λ©”μ„λ“).

write λ©”μ„λ“λ” λ°μ΄ν„°λ¥Ό μ‚½μ…(insert)ν•λ” μ‘μ—…μ„ μν–‰ν•λ©°, μ΄ μ‘μ—…μ„ μν–‰ν•λ ¤λ©΄ λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²° κ°μ²΄(conn)κ°€ ν•„μ”ν•λ‹¤.

Advice: λ¶€κ°€μ μΌλ΅ μ‹¤ν–‰ν•  μ‘μ—…. μ—¬κΈ°μ„ conn κ°μ²΄λ¥Ό ν™μ©ν•΄ λ°μ΄ν„°λ² μ΄μ¤ μ—°κ²°μ„ μ„¤μ •ν•κ±°λ‚, νΈλμ­μ…μ„ κ΄€λ¦¬ν•λ” μ—­ν• μ„ ν•λ‹¤.

Pointcut: νΉμ • λ©”μ„λ“(write)μ—μ„λ§ connμ„ μ‹¤ν–‰ν•λ„λ΅ μ§€μ •ν•λ” κ·μΉ™μ…λ‹λ‹¤. μ΄ κ·μΉ™μ€ AOP ν‘ν„μ‹μΌλ΅ μ •μλλ‹¤.

Advisor: Adviceμ™€ Pointcutμ„ μ—°κ²°ν•λ” κµ¬μ„± μ”μ†λ΅, write λ©”μ„λ“μ—μ„λ§ νΉμ • Adviceκ°€ μ‹¤ν–‰λλ„λ΅ μ„¤μ •ν•λ‹¤.

---

## AOP μ£Όμ” κµ¬μ„± μ”μ†μ™€
### Join Point
  - μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ¤‘μ—μ„ "νΉμ • μ‹μ "μ„ μλ―Έ
  - μ¤ν”„λ§ AODPμ—μ„λ” λ©”μ„λ“ μ‹¤ν–‰ μ‹μ λ§ Join Pointλ΅ κ°„μ£Ό 

### Advice 
- Join Pointμ— μ‚½μ…λλ” λ™μ‘(λ¶€κ°€μ μΈ κΈ°λ¥).
- μ: λ΅κΉ…, νΈλμ­μ… κ΄€λ¦¬, κ¶ν• ν™•μΈ λ“±
- μΆ…λ¥: `@Before`, `@After`, `@AfterReturning`, `@AfterThrowing`, `@Around`

### PointCut
- νΉμ • μ‹μ (Join Point)μ— Adviceλ¥Ό μ μ©ν• μ§€ λ€μƒμ„ ν•„ν„°λ§ν•λ” μ—­ν•  
- μλ¥Ό λ“¤μ–΄, νΉμ • ν΄λμ¤μ νΉμ • λ©”μ„λ“ μ‹¤ν–‰ μ „ν›„μ—λ§ Adviceλ¥Ό μ μ©ν•λ ¤λ” κ²½μ° μ‚¬μ©

### PointCut ν‘ν„μ‹μ κµ¬μ„±
- `execution`, `within`, `this`, `target`
  - execution: λ©”μ„λ“ μ‹¤ν–‰μ— λ€ν• ν¬μΈνΈμ»·μ„ μ •μ
  - within: νΉμ • ν΄λμ¤λ‚ ν¨ν‚¤μ§€ λ‚΄μ—μ„ μ‹¤ν–‰λλ” λ¨λ“  Join Pointλ¥Ό λ§¤μΉ­
  - thisμ™€ target:ν”„λ΅μ‹ κ°μ²΄(this)μ™€ μ›λ³Έ κ°μ²΄(target) κΈ°μ¤€μΌλ΅ ν¬μΈνΈμ»·μ„ μ •μ

- ν•μ‹
```java
execution(μμ‹μ–΄λ¦¬ν„΄νƒ€μ… ν¨ν‚¤μ§€.ν΄λμ¤.λ©”μ„λ“(νλΌλ―Έν„°))
@Before("execution(* com.ex.UserService.getUser(..))")
@Before("within(com.ex.UserService)")
@Before("this(com.ex.ServiceInterface)")
@Before("target(com.ex.ServiceImplementation)")
```

*: μ ‘κ·Ό μ μ–΄μ λ° λ¦¬ν„΄ νƒ€μ…μ€ μƒκ΄€μ—†μ.
com.EX.UserService: λ€μƒ ν΄λμ¤.
getUser(..): λ©”μ„λ“ μ΄λ¦„ λ° νλΌλ―Έν„°. (..)λ” λ¨λ“  νλΌλ―Έν„°λ¥Ό ν—μ©.



---
Join Point: AOPλ¥Ό μ μ©ν•  μ μλ” μ‹μ .
Advice: Join Pointμ— μ‹¤ν–‰λ  λ¶€κ°€ λ™μ‘(λ΅κΉ…, νΈλμ­μ… κ΄€λ¦¬ λ“±).
Pointcut: Join Pointλ¥Ό ν•„ν„°λ§ν•μ—¬ νΉμ • λ€μƒμ—λ§ Adviceλ¥Ό μ μ©.
Aspect: Pointcutκ³Ό Adviceλ¥Ό λ¬¶μ–΄λ†“μ€ μ •μ(ν΄λμ¤).
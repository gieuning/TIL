# 2025-03-16
---
# HTTP(HyperText Transfer Protocol)
- 웹상에서 클라이언트와 서버가 데이터를 주고받기 위한 프로토콜

## HTTP 특징
- 클라이언트-서버 구조
- HTTP 메시지
  - 요청(Request)과 응답(Response) 형태로 통신
- 무상태 프로토콜(Stateless), 기본적으로 **비연결성**
- 주로 TCP/IP 위에서 동작하며, 기본 포트는 **80(HTTP)**, 보안 HTTP는 **443(HTTPS)** 사용

## 클라이언트 서버 구조
- 요청(Request)과 응답(Response) 구조
- 클라이언트는 서버에 요청을 보내고, 응답을 대기
- 서버가 요청에 대한 결과를 만들어서 응답

비즈니스 로직이랑 데이터 같은 것들을 다 서버에다 넣는다.

## 무상태 프로토콜 (Stateless)
- 서버가 클라이언트의 상태를 보존하지 않는다.
- 장점: 서버 부하를 줄이고 확장성이 높으며, 서버 장애 발생 시 복구와 관리가 용이하다.
- 단점: 클라이언트가 추가 데이터 전송을 한다.
  - 데이터를 너무 많이 보내야 한다.. 
  - 고객이 필요한 데이터를 그때그때 다 넘기면 중간에 점원이 바뀌어도 아무 문제가 없다. 
- **웹 애플리케이션을 설계할 때는 최대한 무상태로 설계를 하고, 어쩔 수 없는 경우에 한해서만 상태를 유지한다.** 

### 무상태 프로토콜 한계 극복 방법
- 모든 것을 무상태로 설계 할 수 있는 경우도 있고 없느 경우도 있다.
  - 무상태를 예시로 들자면 로그인이 필요 없는 단순한 서비스 소개 화면이 있다.

무상태 프로토콜에서 상태를 유지하기 위해서는 다음과 같은 기술을 사용한다.

- **쿠키(Cookie)**
    - 클라이언트가 상태 정보를 저장하고 요청 시마다 서버에 전송하여 상태 유지

- **세션(Session)**
    - 서버 측에서 클라이언트별 상태 정보를 저장하고 관리

- **JWT(JSON Web Token)**
    - 클라이언트가 서버에서 발급한 토큰을 갖고 상태 정보를 유지

### 무상태(Stateless) vs 상태 유지(Stateful)

| 항목 | 무상태 프로토콜 | 상태 유지 프로토콜 |
|------|--------------------|-------------------|
| 상태 저장 | 저장하지 않음 | 서버가 상태를 저장함 |
| 서버 부하 | 낮음 | 높음 (상태 정보 관리) |
| 확장성 | 좋음 (스케일링 쉬움) | 제한적 (상태 공유 필요) |
| 대표 예시 | HTTP | FTP, TCP |
---

## 비 연결성
- HTTP는 기본이 연결을 유지하지 않는 모델
- 일반적으로 초 다누이의 이하의 바른 속도로 응답
- 1시간 동안 수천명이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 매우 작다.
  - ex) 웹 브라우저에서 계속 연속해서 검색 버튼을 누르지는 않는다.
- 서버 자원을 매우 효율적으로 사용할 수 있다. 

자원을 받을 때마다 연결하고 받고 다시 끊고 또 연결하면 너무 비효율적이다. 

### 한계와 극복
- TCP/IP 연결을 새로 맺어야 한다. - 3-Way Handshake 시간 추가
- 웹 브라우저로 사이트를 요청하면 HTML 뿐만 아니라, 자바스크립트, CSS, 추가 이미지 등 수 많은 자원이 함께 다운로드
- 지금은 HTTP 지속 연결로 문제 해결이 되었다.

## HTTP 메시지
- HTTP 메시지에 모든 것을 전송 

### 시작 라인(요청 메시지)
- start-line = **request-line** / status-line
- **request-line** = method SP(공백) request-target SP HTTP-version CRLF(엔터)
  - `GET /search?q=hello&hl=ko HTTP/1.1`

### 시작 라인(응답 메시지)
- start-line = request-line / **status-line**
- **status-line** = HTTP-version SP status-code SP reason-phrase CRLF

- HTTP 버전
- HTTP 상태 코드: 요청 성공, 실패를 나타냄

### HTTP 헤더
- header-field = field-name ":" OWS field-value OWS
  - OWS는 띄어쓰기를 허용한다는 것 
- field-name은 대소문자 구문 없음

### HTTP 헤더 용도
- HTTP 전송에 필요한 모든 부가정보
- ex) 메시지 바디의 내용, 메시지 바디의 크기, 압축, 인증, 요청 클라이언트(브라우저) 정보, 서버 애플리케이션 정보, 캐시 관리 정보 등
- 필요시 임의의 헤더 추가 가능 

### HTTP 메시지 바디 용도
- 실제 전송할 데이터
- HTML 문서, 이미지, 영상, JSON 등등 byte로 표현할 수 있는 모든 데이터 전송 가능 

```html
<!--HTTP 메시지 헤더 시작-->
HTTP/1.1 200 OK <!--HTTP 프로토콜 버전과 상태코드를 나타냄-->
Content-Type: text/html;charset=UTF-8 <!--응답 데이터 형식 (생략 시 기본값)-->
Content-Length: 3423           <!-- 메시지 본문의 길이 -->
<!--HTTP 메시지 헤더 종료-->

<!--HTTP 메시지 바디 시작-->
<html>
<body>...</body> 
</html>
<!--HTTP 메시지 바디 종료-->
```




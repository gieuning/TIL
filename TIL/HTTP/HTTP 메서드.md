# 2025-03-17
---
# 리소스의 개념과 행위의 분리 

## 리소스란?
- 리소스는 웹 환경에서 다루는 모든 개별 데이터를 의미한다.
- 일반적으로 회원, 상품, 게시글과 같은 명사 형태로 정의한다.
  - 회원을 등록하고 수정하고 조회하는게 리소스가 아니다
  - 회원이라는 개념 자체가 바로 리소스

**리소스를 어떻게 식별하면 좋을까**
- 회원을 등록하고 수정하고 조회하는 것을 모두 배제
- 회원이라는 리소스만 식별하면 된다. -> 회원 리소스를 URI에 매핑 

### 리소스와 행위를 분리
**가장 중요한 것은 리소스를 식별하는 것**

- URI는 오직 리소스만 식별해야 한다. 
- 리소스와 해당 리소스를 대상으로 하는 행위를 분리
  - 리소스: 회원
  - 행위: 조회, 등록, 삭제, 변경
- `/create-member` - 행위가 포함
- `/update-member` - 행위가 포함 
- `/members` - 리소스만 표현 

우선 HTTP 메서드에 대해서 정리하자면 아래 표와 같다.
## ☑️ HTTP 요청 메서드 종류
| HTTP 메서드 | CRUD | 행위                         | URI 예시 |
|-------------|-------|----------------------------|-----------|
| **GET**     | Read   | 리소스 조회                     | `/members/{id}` |
| **POST**    | Create | 요청 데이터 처리, 주로 등록에 사용       | `/members` |
| **PUT**     | Update | 리소스를 대체, 해당 리소스가 없으면 생성, 수정 | `/members/{id}` |
| **PATCH**   | Partial Update | 리소스 부분 변경                  | `/members/{id}` |
| **DELETE**  | Delete | 리소스 삭제                     | `/members/{id}` |


## GET
- 주로 데이터를 조회하거나, 메시지(간단한 데이터)를 전달할 때 사용한다.
- 서버에 전달하고 싶은 데이터는 쿼리 파라미터를 통해서 전달
- 데이터가 URL에 노출되기 때문에 민감한 정보 전달은 `POST`를 이용한다.
- 메시지 바디를 사용해서 데이터를 전달할 수 있지만, 지원하지 않는 곳이 많아서 권장하지 않는다. 
- `GET /search?q=notebook HTTP/1.1Host: localhost:9090`

**GET 요청 예시**
1. 메시지 전달 
- 클라이언트가 서버에 정보를 보낸다 
  - 특정 회원정보 조회
```http request
GET /members/123 HTTP/1.1
Host: localhost:9090
```
2. 서버 도착
```http request
{
    "username" : "엄자바",
    "age" : 26
}
```

3. 응답 데이터 (Response)
```http request
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 34
{
    "username": "엄자바",
    "age": 26
}
```

### GET 방식 장단점

| 장점               | 단점                      |
|------------------|-------------------------|
| 빠르고 간편한 리소스 조회   | URL 길에 제한이 있음 (약2000자)  |
| 캐싱이 가능하여 속도 향상   | 민감함 데이터 전송 부적합 (URl 노출) |
| 브라우저에서 쉽게 테스트 가능 | 데이터 변경에는 적합하지 않음        |

## POST 
- 요청 데이터 처리
- **메시지 바디를 통해 서버로 요청 데이터 전달**
- 서버는 요청 데이터를 처리
  - 메시지 바디를 통해 들어온 데이터를 처리하는 모든 기능을 수행한다.
- 주로 전달된 데이터로 신규 리소스 등록, 프로세스 처리에 사용 
- 데이터가 요청 본문(body)에 있어 URL에 노출되지 않아 민감한 데이터 전송어 적합하다.
- 이 리소스 URI에 POST 요청이 오면 요청 데이터를 어떻게 처리할지 리소스마다 따로 정해야 한다.

**POST 요청 예시**
1. 메시지 전달
- 데이터를 저장하거나, 내부적으로 어떻게 쓸건지 약속 
```http request
POST /members HTTP/1.1
Content-Type: application/json
{
    "username": "엄자바",
    "age": 26
}
```
2. 신규 리소스 생성 
- /members -> /members/123 신규 리소스 식별자 생성 
```http request
{
    "username" : "엄자바",
    "age" : 26
}
```

3. 응답 데이터 (Response)
```http request
HTTP/1.1 201 Created
Content-Type: application/json
Content-Length: 34
Location: /members/100
{
    "username": "엄자바",
    "age": 26
}
```
## PUT 
- 리소스를 전체적으로 교체하거나 덮어쓸 때 사용 (기존 리소스를 갈아치운다)
  - 리소스가 존재하면 대체
  - 리소스가 존재하지 않으면 생성
- 클라이언트가 리소스를 직접 식별 (리소스를 알고 있어야 한다.)
  - 클라이언트가 지정한 위치에 리소스를 생성 또는 대체

- POST와 차이점 

**PUT 요청 예시**
```http request
PUT /members/123 HTTP/1.1
Host: localhost:9090
Content-Type: application/json

{
    "username": "엄자바",
    "age": 26
}
```
- 기존 회원의 정보가 서버에 있을 경우 리소스는 대체가 된다. 
- 리소스가 없을 경우 생성이 된다. 
- 여기서 만약, 나이만 변경하고 싶어서 "age : 20"을 전송 시 기존에 있던 "username" 필드가 날라가게 된다.
  -  기존 리소스를 삭제하고 완전히 다시 덮어버리고 다시 만들기 때문 (부분만 수정하고 싶다면 PATCH 사용)

## PATCH
- 기존 리소스의 일부 데이터만 수정 할 때 사용
- 리소스가 반드시 존재해야 한다.
- 리소스 일부를 변경하기 위한 데이터를 요청 본문에 담아 보낸다.

## DELETE
- 특정 리소스를 서버에서 삭제할 때 사용


## HTTP 메서드의 속성
- HTTP 메서드는 크게 안전, 멱등, 캐시 가능의 세 가지 속성을 가질 수 있다.

### 안전
- 여러 번 호출해도 서버의 상태가 바뀌지 않는다.
- 주로 조회하는 목적으로 사용
- 여러번 호출했을 때 변경이 일어나는건 안전하지 않은 것

### 멱등
- 같은 요청을 여려 번 반복해도 서버 상태가 동일하게 유지되는 특성
- 동일 요청 반복 시, 항상 같은 결과가 놔야 한다.
- 멱등은 외부 요인으로 중간에 리소스가 변겨오디는 것 까지는 고려하지 않는다.
- 활용
  - 자동 복구 매커니즘
  - 서버가 TIMEOUT 등으로 정상 응답을 못주었을 때, 클라이언트가 같은 요청을 다시 해도 되는가? 판단 근거 

### 캐시 가능
- 응답 결과를 클라이언트(브라우저)나 중간 서버가 저장(캐시)할 수 있는 특성
- 동일 요청 시 서버가 아닌 캐시된 데이터를 반환하여 성능 향상 가능

| HTTP 메서드 | 안전(Safe) | 멱등(Idempotent) | 캐시 가능(Cacheable) |
|-------------|------------|-----------------|---------------------|
| GET         | ✅         | ✅              | ✅                 |
| HEAD        | ✅         | ✅              | ✅                 |
| OPTIONS     | ✅         | ✅              | ❌                 |
| PUT         | ❌         | ✅              | ❌                 |
| DELETE      | ❌         | ✅              | ❌                 |
| POST        | ❌         | ❌              | △(일반적으론 ❌)     |
| PATCH       | ❌         | △(조건적 멱등)   | ❌                 |














